<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="../css/monster.css">
    <title>See Monster</title>
</head>


<body id="main-bg2">
    <div id="main-B2">
        <h1 id="main-heading2">See Monsters</h1>
    </div>
    <div id="play-groundP">
        <a  href="http://localhost:3000">
            <img id="puff2-pic" src="/imgs/Puffle_2014_Transformation_Player_Card_Blue.webp" alt="blue puffle" title="Back Home!">
        </a>
    </div>
    
    <div id="bed">
        
        <img id="redBed" src="/imgs/Red_Bed.PNG.webp" alt="red bed">
    </div>
    
    <script>
        fetch("http://localhost:3000/api/monsterz").then(
        (response) => {return response.json()}).then(
        (response) =>{req = response}).then(
        () => {console.log(req);});
        //Dumb Crap almost all Co pliot  
        // Render created monsters into #bed as a list with images
        (function(){
            const bed = document.getElementById('bed');
            function escapeHtml(s){
                return String(s)
                .replace(/&/g,'&amp;')
                .replace(/</g,'&lt;')
                .replace(/>/g,'&gt;')
                .replace(/"/g,'&quot;')
                .replace(/'/g,'&#39;');
            }
            
            fetch('/api/monsterz')
            .then(res => {
                if (!res.ok) throw new Error('Network response was not ok');
                return res.json();
            })
            .then(data => {
                // data expected to be an array
                bed.innerHTML = '';
                if (!Array.isArray(data) || data.length === 0) {
                    bed.innerHTML = '<p style="color:#fff;text-align:center;">No monsters yet.</p>';
                    return;
                }
                
                const list = document.createElement('ul');
                list.style.listStyle = 'none';
                list.style.display = 'flex';
                list.style.flexWrap = 'wrap';
                list.style.gap = '1rem';
                list.style.padding = '0';
                list.style.justifyContent = 'center';
                
                data.forEach(m => {
                    const li = document.createElement('li');
                    li.style.width = '200px';
                    li.style.textAlign = 'center';
                    li.style.color = '#fff';
                    
                    // Derive candidate image name from type
                    const type = (m.type || '').toString().toLowerCase().replace(/[^a-z0-9]+/g,'_') || 'default';
                    const imgSrc = `/imgs/${type}.gif`;
                    const fallback = '/imgs/wolf.gif';
                    
                    const img = document.createElement('img');
                    img.src = imgSrc;
                    img.alt = escapeHtml(m.name || 'monster');
                    img.style.width = 'auto';
                    img.style.height = '200px';
                    
                    // If candidate missing, fall back to packaged image
                    img.onerror = function(){ this.onerror = null; this.src = fallback; };
                    
                    const title = document.createElement('div');
                    title.innerHTML = `<strong>${escapeHtml(m.name || 'Unnamed')}</strong>`;
                    const meta = document.createElement('div');
                    meta.style.fontSize = '1em';
                    meta.style.opacity = '1';
                    
                    meta.innerText = `${m.type || ''} â€” ${m.country || ''}`;
                    
                    li.appendChild(img);
                    li.appendChild(title);
                    li.appendChild(meta);
                    list.appendChild(li);
                });
                
                bed.appendChild(list);
            })
            .catch(err => {
                bed.innerHTML = `<p style="color: red;">Error: ${escapeHtml(err.message)}</p>`;
                console.error('There was a problem with the fetch operation:', err);
            });
        })();
    </script>
    <div id="musik2">
    <iframe width="20%" height="50" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/soundcloud%253Atracks%253A686184889&color=%2341bafd&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true"></iframe><div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;"><a href="https://soundcloud.com/noah-foreman-926095843" title="Skookummaxx" target="_blank" style="color: #cccccc; text-decoration: none;"></a> <a href="https://soundcloud.com/noah-foreman-926095843/animal-village-the-legend-of-zelda-links-awakening" title="Animal Village - The Legend of Zelda Links Awakening" target="_blank" style="color: #cccccc; text-decoration: none;"></a></div>
    </div>
</body>

</html>

